{"ast":null,"code":"import _slicedToArray from\"D:/vscommunity/ExpenseTrackerFront/expensetracker/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"D:/vscommunity/ExpenseTrackerFront/expensetracker/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"D:/vscommunity/ExpenseTrackerFront/expensetracker/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useEffect,useState}from\"react\";import{CircularProgress}from'@material-ui/core';import PursesDoughnutDiagram from'../Diagrams/PursesDoughnutDiagram';import{Grid,makeStyles,Paper,Tab,Tabs,Typography,Box}from'@material-ui/core';import useSessionStorage from'../../CustomHooks/StorageHooks/useSessionStorage';import{GetCurrentUserPurses}from'../../Services/purse.services/Purse.service';import{GetExpensesSumForToday}from\"../../Services/expense.service/ExpenseService\";import{CountDays}from\"../../Date/CountDays\";import ExpensesList from\"../ExpensesList/ExpensesList\";import GridPaperHeader from\"../GridPaper/GridPaperHeader\";var TabPanel=function TabPanel(props){var children=props.children,value=props.value,index=props.index,other=_objectWithoutProperties(props,[\"children\",\"value\",\"index\"]);return/*#__PURE__*/_jsx(\"div\",_objectSpread(_objectSpread({role:\"tabpanel\",hidden:value!==index,id:\"simple-tabpanel-\".concat(index),\"aria-labelledby\":\"simple-tab-\".concat(index)},other),{},{children:value===index&&/*#__PURE__*/_jsx(Box,{p:0,m:4,children:children})}));};var useStyles=makeStyles({root:{flexGrow:1,widht:\"fit-content\"}});var HomePage=function HomePage(){var classes=useStyles();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoadingPurses=_useState2[0],setIsLoadingPurses=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoadingExpenses=_useState4[0],setIsLoadingExpenses=_useState4[1];var _useSessionStorage=useSessionStorage(\"pursesData\",[]),_useSessionStorage2=_slicedToArray(_useSessionStorage,2),pursesData=_useSessionStorage2[0],setPursesData=_useSessionStorage2[1];var _useSessionStorage3=useSessionStorage(\"dailyExpenseSum\",[]),_useSessionStorage4=_slicedToArray(_useSessionStorage3,2),dailyExpenseSum=_useSessionStorage4[0],setDailyExpenseSum=_useSessionStorage4[1];var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),value=_React$useState2[0],setValue=_React$useState2[1];var handleChange=function handleChange(event,newValue){setValue(newValue);};useEffect(function(){GetCurrentUserPurses().then(function(result){if(result.response.status==200){setPursesData(result.data);setIsLoadingPurses(false);}}).catch(function(error){console.log(error);});GetExpensesSumForToday().then(function(result){if(result.response.status==200){setDailyExpenseSum(result.data);setIsLoadingExpenses(false);}}).catch(function(error){console.log(error);});},[]);if(isLoadingPurses||isLoadingExpenses){return/*#__PURE__*/_jsx(Grid,{container:true,xs:12,justify:\"center\",children:/*#__PURE__*/_jsx(CircularProgress,{color:\"secondary\"})});}return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(Grid,{container:true,item:true,justify:\"center\",className:\"contentDiv\",xs:10,xl:9,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:11,children:/*#__PURE__*/_jsxs(Paper,{elevation:12,children:[/*#__PURE__*/_jsx(GridPaperHeader,{}),/*#__PURE__*/_jsxs(Grid,{container:true,justify:\"center\",className:classes.root,children:[pursesData.length==0&&/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:\"There are not any purses\"}),/*#__PURE__*/_jsx(Grid,{component:Tabs,item:true,value:value,onChange:handleChange,indicatorColor:\"primary\",textColor:\"primary\",centered:true,children:pursesData.map(function(purse){return/*#__PURE__*/_jsx(Grid,{component:Tab,item:true,label:/*#__PURE__*/_jsx(Typography,{variant:\"h5\",children:purse.currencyCode.toUpperCase()})},purse.id);})})]}),/*#__PURE__*/_jsx(Grid,{container:true,item:true,justify:\"center\",xs:12,children:pursesData.map(function(purse,index){var expense=dailyExpenseSum.find(function(e){return e.currencyCode==purse.currencyCode;});var sum=0;var countDays=CountDays();if(expense!=undefined){sum=expense.sum;}var rest=purse.bill/countDays-sum;if(rest<0){rest=0;}return/*#__PURE__*/_jsx(Grid,{item:true,xs:12,component:TabPanel,value:value,index:index,children:/*#__PURE__*/_jsx(PursesDoughnutDiagram,{title:\"Daily expenses, purse \"+purse.currencyCode.toUpperCase(),labels:[\"Remaining money\",\"Daily expenses\"],data:[Number(rest.toFixed(2)),Number(sum.toFixed(2))]})},index);})})]})}),/*#__PURE__*/_jsx(ExpensesList,{})]})});};export default HomePage;","map":{"version":3,"sources":["D:/vscommunity/ExpenseTrackerFront/expensetracker/src/Components/Pages/HomePage.tsx"],"names":["React","useEffect","useState","CircularProgress","PursesDoughnutDiagram","Grid","makeStyles","Paper","Tab","Tabs","Typography","Box","useSessionStorage","GetCurrentUserPurses","GetExpensesSumForToday","CountDays","ExpensesList","GridPaperHeader","TabPanel","props","children","value","index","other","useStyles","root","flexGrow","widht","HomePage","classes","isLoadingPurses","setIsLoadingPurses","isLoadingExpenses","setIsLoadingExpenses","pursesData","setPursesData","dailyExpenseSum","setDailyExpenseSum","setValue","handleChange","event","newValue","then","result","response","status","data","catch","error","console","log","length","map","purse","currencyCode","toUpperCase","id","expense","find","e","sum","countDays","undefined","rest","bill","Number","toFixed"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { CircularProgress } from '@material-ui/core';\r\nimport PursesDoughnutDiagram from '../Diagrams/PursesDoughnutDiagram';\r\nimport { Grid, makeStyles, Paper, Tab, Tabs, Typography, Box } from '@material-ui/core';\r\nimport { PursesDefault } from '../../Data/Models/Purses/default/PurseDefault';\r\nimport useSessionStorage from '../../CustomHooks/StorageHooks/useSessionStorage';\r\nimport Purse from '../../Data/Models/Purses/Purse';\r\nimport { GetCurrentUserPurses } from '../../Services/purse.services/Purse.service';\r\nimport { ExpensesForSumDefault } from \"../../Data/Models/Expenses/default/ExpenseForSumDefault\";\r\nimport { ExpenseForSum } from \"../../Data/Models/Expenses/ExpenseForSum\";\r\nimport { GetExpensesSumForToday } from \"../../Services/expense.service/ExpenseService\";\r\nimport { CountDays } from \"../../Date/CountDays\";\r\nimport ExpensesList from \"../ExpensesList/ExpensesList\";\r\nimport GridPaperHeader from \"../GridPaper/GridPaperHeader\";\r\n\r\ninterface TabPanelProps {\r\n    index: number,\r\n    value: number,\r\n  }\r\n  \r\n  const TabPanel: React.FC<TabPanelProps> = (props) => {\r\n    const { children, value, index, ...other } = props;\r\n  \r\n    return (\r\n      <div\r\n        role=\"tabpanel\"\r\n        hidden={value !== index}\r\n        id={`simple-tabpanel-${index}`}\r\n        aria-labelledby={`simple-tab-${index}`}\r\n        {...other}\r\n      >\r\n        {value === index && (\r\n          <Box p={0} m={4}>\r\n              {children}\r\n          </Box>\r\n        )}\r\n      </div>\r\n    );\r\n  }  \r\n\r\nconst useStyles = makeStyles({\r\n    root: {\r\n      flexGrow: 1,\r\n      widht: \"fit-content\"\r\n    },\r\n  });\r\n  \r\nconst HomePage: React.FC = () => {\r\n\r\n    const classes = useStyles();\r\n    const [isLoadingPurses, setIsLoadingPurses] = useState(true);\r\n    const [isLoadingExpenses, setIsLoadingExpenses] = useState(true);\r\n    const [pursesData, setPursesData] = useSessionStorage<Purse[]>(\r\n        \"pursesData\", []\r\n        );\r\n    const [dailyExpenseSum, setDailyExpenseSum] = useSessionStorage<ExpenseForSum[]>(\r\n        \"dailyExpenseSum\", []\r\n        );\r\n    const [value, setValue] = React.useState(0);\r\n\r\n    const handleChange = (event: React.ChangeEvent<{}>, newValue: number) => {\r\n        setValue(newValue);\r\n    };\r\n\r\n    useEffect(() => {\r\n        \r\n        GetCurrentUserPurses()\r\n                .then(result => {\r\n                    if(result.response.status == 200)\r\n                    {\r\n                        setPursesData(result.data);\r\n                        setIsLoadingPurses(false);\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    console.log(error);\r\n                })\r\n\r\n        GetExpensesSumForToday()\r\n                .then(result => {\r\n\r\n                    if(result.response.status == 200)\r\n                    {\r\n                        setDailyExpenseSum(result.data);\r\n                        setIsLoadingExpenses(false);\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    console.log(error);\r\n                });\r\n        \r\n      }, []);\r\n\r\n      if(isLoadingPurses || isLoadingExpenses)\r\n      {\r\n        return(\r\n        <Grid container xs={12} justify=\"center\">\r\n            <CircularProgress color=\"secondary\" />\r\n        </Grid>\r\n        );\r\n      }\r\n    \r\n    return(\r\n        <React.Fragment>\r\n            <Grid container item\r\n             justify=\"center\" className=\"contentDiv\" xs={10} xl={9}\r\n             >\r\n                <Grid item xs={11}>\r\n                    <Paper elevation={12}>\r\n                        <GridPaperHeader />\r\n                        <Grid container justify=\"center\" className={classes.root}>\r\n                            {pursesData.length == 0 &&\r\n                            <Typography variant=\"h4\">\r\n                                There are not any purses\r\n                            </Typography>\r\n                            }\r\n                            <Grid\r\n                                component={Tabs}\r\n                                item\r\n                                value={value}\r\n                                onChange={handleChange}\r\n                                indicatorColor=\"primary\"\r\n                                textColor=\"primary\"\r\n                                centered\r\n                            >\r\n                                {pursesData.map((purse) => (\r\n                                    <Grid component={Tab} item key={purse.id} \r\n                                    label={\r\n                                    <Typography variant=\"h5\">\r\n                                        {purse.currencyCode.toUpperCase()}\r\n                                    </Typography>}/>\r\n                                ))}\r\n                            </Grid>\r\n                        </Grid>\r\n                        <Grid container item justify=\"center\" xs={12}>\r\n                            {pursesData.map((purse, index) => {\r\n                                let expense = dailyExpenseSum.find(e => \r\n                                    e.currencyCode == purse.currencyCode);\r\n                                let sum:number = 0;\r\n                                let countDays: number = CountDays(); \r\n                                if(expense != undefined)\r\n                                {\r\n                                    sum = expense.sum;\r\n                                }\r\n\r\n                                let rest: number = purse.bill / countDays - sum;\r\n                                if(rest < 0)\r\n                                {\r\n                                    rest = 0;\r\n                                }\r\n\r\n                                return(\r\n                                <Grid item xs={12} key={index}\r\n                                component={TabPanel} value={value} index={index}>\r\n                                    <PursesDoughnutDiagram \r\n                                        title={\"Daily expenses, purse \" + purse.currencyCode.toUpperCase()}\r\n                                        labels={[\"Remaining money\", \"Daily expenses\" ]}\r\n                                        data={[Number((rest).toFixed(2)), Number((sum).toFixed(2))]}                        \r\n                                    />\r\n                                </Grid>\r\n                                )})}\r\n                        </Grid>\r\n                    </Paper>\r\n                </Grid>\r\n                <ExpensesList />\r\n            </Grid>\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nexport default HomePage;"]},"metadata":{},"sourceType":"module"}