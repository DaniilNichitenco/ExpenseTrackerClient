{"ast":null,"code":"import _slicedToArray from\"D:/vscommunity/ExpenseTrackerFront/expensetracker/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Grid,makeStyles,Typography,Divider,Dialog}from'@material-ui/core';import React,{useEffect,useState}from'react';import'./PageStyles.css';import FlyingGridTile from'../Tiles/FlyingGridTile';import{CircularProgress}from'@material-ui/core';import useSessionStorage from'../../CustomHooks/StorageHooks/useSessionStorage';import PurseExpenseTable from'../Tables/PurseExpenseTable';import{GetCurrentUserPurses}from'../../Services/purse.services/Purse.service';import EditProfileButton from'../Buttons/EditProfileButton';import{GetCountUserExpenses}from'../../Services/expense.service/ExpenseService';import{GetCurrentUserData}from'../../Services/user.services/User.service';import EditProfileForm from'../Forms/EditProfileForm/EditProfileForm';import{useHistory}from'react-router-dom';var useStyles=makeStyles(function(theme){return{contentList:{justifyContent:\"center\",overflowX:\"hidden\",height:\"fit-content\",padding:20},tile:{border:\"1px solid black\"},paperTile:{borderRadius:\"15px 15px 7px 7px\",height:\"fit-content\",width:300,backgroundColor:'#A0ABEF'},userStatusText:{fontFamily:\"Lucida Bright\"},nameText:{fontFamily:\"Candara\",fontSize:\"inherit\",fontWeight:\"inherit\"},profileHeader:{marginBottom:10,color:theme.palette.primary.dark},buttonSetting:{margin:5},name:{color:theme.palette.primary.dark,marginBottom:15},subInfo:{color:theme.palette.primary.dark}};});var ProfilePage=function ProfilePage(){var _useSessionStorage=useSessionStorage(\"userData\",undefined),_useSessionStorage2=_slicedToArray(_useSessionStorage,2),userData=_useSessionStorage2[0],setUserData=_useSessionStorage2[1];// const [isLoadingUser, setIsLoadingUser] = useState<boolean>(true);\nvar classes=useStyles();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoadingPurses=_useState2[0],setIsLoadingPurses=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoadingExpenses=_useState4[0],setIsLoadingExpenses=_useState4[1];var _useSessionStorage3=useSessionStorage(\"pursesData\",[]),_useSessionStorage4=_slicedToArray(_useSessionStorage3,2),pursesData=_useSessionStorage4[0],setPursesData=_useSessionStorage4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),countExpenses=_useState6[0],setCountExpenses=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isOpen=_useState8[0],setIsOpen=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),rerender=_useState10[0],setRerender=_useState10[1];var _useSessionStorage5=useSessionStorage(\"dailyExpenseSum\",[]),_useSessionStorage6=_slicedToArray(_useSessionStorage5,3),dailyExpenseSum=_useSessionStorage6[0],setDailyExpenseSum=_useSessionStorage6[1],removeDailyExpenseSum=_useSessionStorage6[2];var _useSessionStorage7=useSessionStorage(\"monlyExpenseSum\",[]),_useSessionStorage8=_slicedToArray(_useSessionStorage7,3),monlyExpenseSum=_useSessionStorage8[0],setMonlyExpenseSum=_useSessionStorage8[1],removeMonthlyExpenseSum=_useSessionStorage8[2];var _useSessionStorage9=useSessionStorage(\"yearlyExpenseSum\",[]),_useSessionStorage10=_slicedToArray(_useSessionStorage9,3),yearlyExpenseSum=_useSessionStorage10[0],setYearlyExpenseSum=_useSessionStorage10[1],removeYearlyExpenseSum=_useSessionStorage10[2];var history=useHistory();useEffect(function(){if(rerender){removeDailyExpenseSum();removeMonthlyExpenseSum();removeYearlyExpenseSum();GetCountUserExpenses().then(function(res){if(res.response.status==200){setCountExpenses(res.data);setIsLoadingExpenses(false);}});GetCurrentUserPurses().then(function(result){if(result.response.status==200){setPursesData(result.data);setIsLoadingPurses(false);}}).catch(function(error){console.log(error);});GetCurrentUserData().then(function(res){if(res.status==200){setUserData(res.data);// setIsLoadingUser(false);\n}}).catch(function(error){console.log(error);});}setRerender(false);},[rerender]);var handleOpen=function handleOpen(){setIsOpen(true);};var handleClose=function handleClose(){// setIsLoadingUser(true);\nsetRerender(true);setIsOpen(false);history.push(\"/au/profile\");};// if(isLoadingUser)\n// {\n//     return(\n//         <Grid container xs={12} >\n//             <CircularProgress color=\"secondary\" />\n//         </Grid>\n//     )\n// }\nreturn/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(Grid,{container:true,justify:\"center\",className:\"contentDiv\",xs:10,xl:9,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:10,className:classes.profileHeader,children:/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:\"User profile\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Divider,{variant:\"middle\"})}),/*#__PURE__*/_jsxs(Grid,{xs:12,container:true,className:classes.contentList,children:[/*#__PURE__*/_jsx(FlyingGridTile,{xl:10,xs:11,paddingBottom:16,children:/*#__PURE__*/_jsxs(Grid,{spacing:3,style:{height:\"fit-content\",justifyContent:\"center\"},container:true,children:[/*#__PURE__*/_jsxs(Grid,{container:true,item:true,xs:12,className:\"boxAvatar\",children:[/*#__PURE__*/_jsx(Grid,{xs:12,container:true,direction:\"row-reverse\",children:/*#__PURE__*/_jsx(EditProfileButton,{onClick:handleOpen,style:{margin:5}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,style:{height:170}})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,className:classes.name,children:/*#__PURE__*/_jsx(Typography,{variant:\"h4\",align:\"center\",style:{fontWeight:600},children:userData==undefined?/*#__PURE__*/_jsx(CircularProgress,{color:\"secondary\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[userData.firstName,\" \",userData.lastName]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,className:classes.subInfo,children:/*#__PURE__*/_jsx(Typography,{align:\"center\",variant:\"h6\",children:userData==undefined?/*#__PURE__*/_jsx(CircularProgress,{color:\"secondary\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Email:\"}),\" \",userData.email]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,className:classes.subInfo,children:/*#__PURE__*/_jsx(Typography,{align:\"center\",variant:\"h6\",children:userData==undefined?/*#__PURE__*/_jsx(CircularProgress,{color:\"secondary\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"UserName:\"}),\" \",userData.userName]})})}),/*#__PURE__*/_jsx(Divider,{variant:\"middle\"}),/*#__PURE__*/_jsxs(Grid,{justify:\"space-between\",container:true,item:true,xs:11,children:[/*#__PURE__*/_jsx(Grid,{item:true,className:classes.subInfo,children:/*#__PURE__*/_jsx(Typography,{children:isLoadingPurses?/*#__PURE__*/_jsx(CircularProgress,{color:\"secondary\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Count purses:\"}),/*#__PURE__*/_jsx(\"br\",{}),pursesData.length]})})}),/*#__PURE__*/_jsx(Grid,{item:true,className:classes.subInfo,children:/*#__PURE__*/_jsx(Typography,{children:isLoadingExpenses?/*#__PURE__*/_jsx(CircularProgress,{color:\"secondary\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Count expenses:\"}),/*#__PURE__*/_jsx(\"br\",{}),countExpenses]})})})]})]})}),/*#__PURE__*/_jsx(FlyingGridTile,{xl:10,xs:11,children:/*#__PURE__*/_jsx(PurseExpenseTable,{})})]}),/*#__PURE__*/_jsx(Dialog,{open:isOpen,children:/*#__PURE__*/_jsx(EditProfileForm,{handleClose:handleClose})})]})});};export default ProfilePage;","map":{"version":3,"sources":["D:/vscommunity/ExpenseTrackerFront/expensetracker/src/Components/Pages/ProfilePage.tsx"],"names":["Grid","makeStyles","Typography","Divider","Dialog","React","useEffect","useState","FlyingGridTile","CircularProgress","useSessionStorage","PurseExpenseTable","GetCurrentUserPurses","EditProfileButton","GetCountUserExpenses","GetCurrentUserData","EditProfileForm","useHistory","useStyles","theme","contentList","justifyContent","overflowX","height","padding","tile","border","paperTile","borderRadius","width","backgroundColor","userStatusText","fontFamily","nameText","fontSize","fontWeight","profileHeader","marginBottom","color","palette","primary","dark","buttonSetting","margin","name","subInfo","ProfilePage","undefined","userData","setUserData","classes","isLoadingPurses","setIsLoadingPurses","isLoadingExpenses","setIsLoadingExpenses","pursesData","setPursesData","countExpenses","setCountExpenses","isOpen","setIsOpen","rerender","setRerender","dailyExpenseSum","setDailyExpenseSum","removeDailyExpenseSum","monlyExpenseSum","setMonlyExpenseSum","removeMonthlyExpenseSum","yearlyExpenseSum","setYearlyExpenseSum","removeYearlyExpenseSum","history","then","res","response","status","data","result","catch","error","console","log","handleOpen","handleClose","push","firstName","lastName","email","userName","length"],"mappings":"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","sourcesContent":["import { Grid, makeStyles, Typography, Divider, DialogContent, Button, Dialog, DialogActions, DialogContentText, DialogTitle } from '@material-ui/core';\r\nimport React, { useEffect, useState } from 'react';\r\nimport './PageStyles.css';\r\nimport FlyingGridTile from '../Tiles/FlyingGridTile';\r\nimport { CircularProgress } from '@material-ui/core';\r\nimport User from '../../Data/Models/User/User';\r\nimport useSessionStorage from '../../CustomHooks/StorageHooks/useSessionStorage';\r\nimport PurseExpenseTable from '../Tables/PurseExpenseTable';\r\nimport Purse from '../../Data/Models/Purses/Purse';\r\nimport { GetCurrentUserPurses } from '../../Services/purse.services/Purse.service';\r\nimport EditProfileButton from '../Buttons/EditProfileButton';\r\nimport { GetCountUserExpenses } from '../../Services/expense.service/ExpenseService';\r\nimport { GetCurrentUserData } from '../../Services/user.services/User.service';\r\nimport ExpenseForSum from '../../Data/Models/Expenses/ExpenseForSum';\r\nimport EditProfileForm from '../Forms/EditProfileForm/EditProfileForm';\r\nimport { useHistory } from 'react-router-dom';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    contentList: {\r\n        justifyContent:\"center\",\r\n        overflowX: \"hidden\",\r\n        height: \"fit-content\",\r\n        padding: 20\r\n    },\r\n    tile: {\r\n        border: \"1px solid black\"\r\n    },\r\n    paperTile: {\r\n        borderRadius: \"15px 15px 7px 7px\",\r\n        height: \"fit-content\",\r\n        width: 300,\r\n        backgroundColor: '#A0ABEF'\r\n      },\r\n      userStatusText: {\r\n          fontFamily: \"Lucida Bright\"\r\n      },\r\n      nameText: {\r\n          fontFamily: \"Candara\",\r\n          fontSize: \"inherit\",\r\n          fontWeight: \"inherit\"\r\n      },\r\n      profileHeader: {\r\n        marginBottom:10,\r\n        color: theme.palette.primary.dark\r\n    },\r\n    buttonSetting: {\r\n        margin: 5\r\n    },\r\n    name: {\r\n        color: theme.palette.primary.dark,\r\n        marginBottom: 15,\r\n    },\r\n    subInfo: {\r\n        color: theme.palette.primary.dark,\r\n    }\r\n}));\r\n\r\nconst ProfilePage: React.FC = () => {\r\n\r\n    const [userData, setUserData] = useSessionStorage<User | undefined>(\"userData\", \r\n    undefined);\r\n    // const [isLoadingUser, setIsLoadingUser] = useState<boolean>(true);\r\n    const classes = useStyles();\r\n    const [isLoadingPurses, setIsLoadingPurses] = useState(true);\r\n    const [isLoadingExpenses, setIsLoadingExpenses] = useState(true);\r\n    const [pursesData, setPursesData] = useSessionStorage<Purse[]>(\"pursesData\", []);\r\n    const [countExpenses, setCountExpenses] = useState<number>(0);\r\n    const [isOpen, setIsOpen] = useState<boolean>(false);\r\n    const [rerender, setRerender] = useState<boolean>(true);\r\n    const [dailyExpenseSum, setDailyExpenseSum , removeDailyExpenseSum] = useSessionStorage<ExpenseForSum[]>(\r\n        \"dailyExpenseSum\", []\r\n        );\r\n    const [monlyExpenseSum, setMonlyExpenseSum, removeMonthlyExpenseSum] = useSessionStorage<ExpenseForSum[]>(\r\n        \"monlyExpenseSum\", []\r\n        );\r\n    const [yearlyExpenseSum, setYearlyExpenseSum, removeYearlyExpenseSum] = useSessionStorage<ExpenseForSum[]>(\r\n        \"yearlyExpenseSum\", []\r\n        );\r\n\r\n    const history = useHistory();\r\n\r\n\r\n    useEffect(() => {\r\n        if(rerender)\r\n        {\r\n            removeDailyExpenseSum();\r\n            removeMonthlyExpenseSum();\r\n            removeYearlyExpenseSum();\r\n            GetCountUserExpenses().then(res => {\r\n                if(res.response.status == 200)\r\n                {\r\n                    setCountExpenses(res.data);\r\n                    setIsLoadingExpenses(false);\r\n                }\r\n            });\r\n            GetCurrentUserPurses()\r\n                .then(result => {\r\n                    if(result.response.status == 200)\r\n                    {\r\n                        setPursesData(result.data);\r\n                        setIsLoadingPurses(false);\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    console.log(error);\r\n                });\r\n            GetCurrentUserData()\r\n                .then(res => {\r\n                    if(res.status == 200)\r\n                    {\r\n                        setUserData(res.data);\r\n                        // setIsLoadingUser(false);\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    console.log(error);\r\n                });\r\n        }\r\n        setRerender(false);\r\n    }, [rerender]);\r\n\r\n    const handleOpen = () => {\r\n        setIsOpen(true);\r\n    }\r\n\r\n    const handleClose = () => {\r\n        // setIsLoadingUser(true);\r\n        setRerender(true);\r\n        setIsOpen(false);\r\n        history.push(\"/au/profile\");\r\n    }\r\n\r\n    // if(isLoadingUser)\r\n    // {\r\n    //     return(\r\n    //         <Grid container xs={12} >\r\n    //             <CircularProgress color=\"secondary\" />\r\n    //         </Grid>\r\n    //     )\r\n    // }\r\n\r\n    return(\r\n        <React.Fragment> \r\n            <Grid container justify=\"center\" className=\"contentDiv\" xs={10} xl={9}>\r\n                <Grid item xs={10} className={classes.profileHeader}>\r\n                    <Typography variant=\"h4\">\r\n                        User profile\r\n                    </Typography>\r\n                </Grid>\r\n                <Grid item xs={12}>\r\n                    <Divider variant=\"middle\" />\r\n                </Grid>\r\n                <Grid xs={12} container className={classes.contentList}>\r\n                    <FlyingGridTile xl={10} xs={11} paddingBottom={16}>\r\n                        <Grid spacing={3} style={{height:\"fit-content\",\r\n                            justifyContent: \"center\",}} container>\r\n                            <Grid container item xs={12} className=\"boxAvatar\">\r\n                                    <Grid xs={12} container direction=\"row-reverse\">\r\n                                        <EditProfileButton onClick={handleOpen}\r\n                                        style={{margin: 5}} />\r\n                                    </Grid>\r\n                                    <Grid item xs={12} style={{height: 170}} />\r\n                            </Grid>\r\n                            <Grid item xs={12} className={classes.name}>\r\n                                <Typography variant=\"h4\"\r\n                                align=\"center\" style={{fontWeight:600}} >\r\n                                    {userData == undefined ? <CircularProgress color=\"secondary\" />\r\n                                    : <>{userData.firstName} {userData.lastName}</>\r\n                                    }\r\n                                </Typography>\r\n                            </Grid>\r\n                            <Grid item xs={12} className={classes.subInfo}>\r\n                                <Typography align=\"center\" variant=\"h6\">\r\n                                    {userData == undefined ? <CircularProgress color=\"secondary\" />\r\n                                    : <><b>Email:</b> {userData.email}</>\r\n                                    }\r\n                                </Typography>\r\n                            </Grid>\r\n                            <Grid item xs={12} className={classes.subInfo}>\r\n                                <Typography align=\"center\" variant=\"h6\">\r\n                                    {userData == undefined ? <CircularProgress color=\"secondary\" />\r\n                                    : <><b>UserName:</b> {userData.userName}</>\r\n                                    }\r\n                                </Typography>\r\n                            </Grid>\r\n                            <Divider variant=\"middle\" />\r\n                            <Grid justify=\"space-between\" container item xs={11}>\r\n                                <Grid item className={classes.subInfo}>\r\n                                    <Typography>\r\n                                        {\r\n                                            isLoadingPurses ? (<CircularProgress color=\"secondary\" />) :\r\n                                                <><b>Count purses:</b><br/>{pursesData.length}</>\r\n                                        }    \r\n                                        </Typography>\r\n                                </Grid>\r\n                                <Grid item className={classes.subInfo}>\r\n                                    <Typography>\r\n                                        {\r\n                                            isLoadingExpenses ? (<CircularProgress color=\"secondary\" />) : \r\n                                            <><b>Count expenses:</b><br/>{countExpenses}</>\r\n                                        }\r\n                                    </Typography>\r\n                                </Grid>\r\n                            </Grid>\r\n                        </Grid>\r\n                    </FlyingGridTile>\r\n                    <FlyingGridTile xl={10} xs={11}>\r\n                        <PurseExpenseTable />\r\n                    </FlyingGridTile>\r\n                </Grid>\r\n                <Dialog open={isOpen}>\r\n                    <EditProfileForm handleClose={handleClose} />\r\n                </Dialog>\r\n            </Grid>\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nexport default ProfilePage;"]},"metadata":{},"sourceType":"module"}